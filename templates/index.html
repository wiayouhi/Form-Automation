<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WIA : Automate Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #6366f1;
            --secondary: #ec4899;
            --bg-dark: #0f172a;
            --glass: rgba(30, 41, 59, 0.75);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--bg-dark);
            font-family: 'Outfit', sans-serif;
            color: white;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Animated Background --- */
        .bg-animate {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 15% 50%, rgba(99, 102, 241, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(236, 72, 153, 0.15) 0%, transparent 25%);
            animation: bg-pulse 10s ease-in-out infinite alternate;
        }
        @keyframes bg-pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }

        .grid-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
            mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
        }

        /* --- Glassmorphism --- */
        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
        ::-webkit-scrollbar-track { background: #1e293b; }

        /* --- Animations --- */
        .slide-up { animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; transform: translateY(30px); }
        @keyframes slideUp { to { opacity: 1; transform: translateY(0); } }
        
        .fade-in { animation: fadeIn 0.8s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { to { opacity: 1; } }

        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; transform: scale(0.8); opacity: 0; }
        @keyframes popIn { to { transform: scale(1); opacity: 1; } }

        .tilt-card { transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .tilt-card:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 10px 40px -10px rgba(99,102,241,0.3); }

        /* --- Page Transition Animations --- */
        .page-enter {
            animation: pageEnter 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @keyframes pageEnter {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .page-exit {
            animation: pageExit 0.3s ease-in forwards;
        }
        @keyframes pageExit {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.98); }
        }

        /* --- Custom Toast Notification --- */
        #toast-container {
            position: fixed; top: 20px; right: 20px; z-index: 9999;
            display: flex; flex-direction: column; gap: 10px;
        }
        .toast-item {
            animation: toastSlideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            transform: translateX(100%); opacity: 0;
        }
        @keyframes toastSlideIn { to { transform: translateX(0); opacity: 1; } }
        .toast-exit { animation: toastSlideOut 0.4s forwards; }
        @keyframes toastSlideOut { to { transform: translateX(100%); opacity: 0; } }

        /* --- Loader --- */
        #loader {
            position: fixed; inset: 0; z-index: 100;
            background: #000;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.8s ease, visibility 0.8s;
        }
        .loader-text span {
            display: inline-block; opacity: 0; transform: translateY(20px);
            animation: reveal 0.5s forwards;
            font-family: 'Space Grotesk', sans-serif; font-weight: 900; font-size: 3rem;
            background: linear-gradient(to right, #818cf8, #c084fc);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        @keyframes reveal { to { opacity: 1; transform: translateY(0); } }

        /* --- Nav & Tags --- */
        .nav-item.active {
            background: linear-gradient(90deg, rgba(99,102,241,0.2), transparent);
            border-left: 3px solid #818cf8;
            color: #818cf8;
        }
        .tag-chip { animation: popIn 0.3s ease-out; }

        /* --- Mobile Floating Menu --- */
        .mobile-dock {
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }
        .mobile-nav-btn.active i {
            color: #818cf8;
            text-shadow: 0 0 15px rgba(129, 140, 248, 0.5);
        }
    </style>
</head>
<body class="antialiased selection:bg-indigo-500 selection:text-white">

    <div id="toast-container"></div>

    <div id="loader">
        <div class="loader-text space-x-2">
            <span style="animation-delay: 0.1s">W</span>
            <span style="animation-delay: 0.2s">I</span>
            <span style="animation-delay: 0.3s">A</span>
            <span style="animation-delay: 0.4s">_</span>
            <span style="animation-delay: 0.5s">P</span>
            <span style="animation-delay: 0.6s">R</span>
            <span style="animation-delay: 0.7s">O</span>
        </div>
    </div>

    <div class="bg-animate"></div>
    <div class="grid-bg"></div>

    <div class="flex h-screen overflow-hidden max-w-[1600px] mx-auto relative">
        
        <aside class="hidden md:flex w-64 glass-panel border-r border-slate-700 flex-col z-20 transition-all duration-300">
            <div class="p-6 flex items-center justify-start">
                <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-500/30">
                    <i class="fa-solid fa-robot text-white text-lg"></i>
                </div>
                <h1 class="ml-4 text-xl font-bold tracking-wider">AUTO<span class="text-indigo-400">PRO</span></h1>
            </div>

            <nav class="mt-8 flex-1 space-y-2 px-2">
                <button onclick="switchTab('home')" id="nav-home" class="nav-item w-full flex items-center p-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-lg transition-all active">
                    <i class="fa-solid fa-house w-6 text-center"></i>
                    <span class="ml-3 font-medium">Overview</span>
                </button>
                <button onclick="switchTab('tool')" id="nav-tool" class="nav-item w-full flex items-center p-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-lg transition-all">
                    <i class="fa-solid fa-bolt w-6 text-center"></i>
                    <span class="ml-3 font-medium">Automation Console</span>
                </button>
            </nav>

            <div class="p-4 border-t border-slate-700/50 space-y-3">
                <div class="glass-panel p-3 rounded-xl">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-[10px] text-slate-400 font-bold uppercase">Server Load</span>
                        <i class="fa-solid fa-server text-indigo-400 text-xs"></i>
                    </div>
                    <div class="space-y-2">
                        <div>
                            <div class="flex justify-between text-[10px] text-slate-300 mb-1">
                                <span>CPU</span>
                                <span id="cpu-val" class="text-indigo-300">0%</span>
                            </div>
                            <div class="h-1 bg-slate-700 rounded-full overflow-hidden">
                                <div id="cpu-bar" class="h-full bg-indigo-500 rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] text-slate-300 mb-1">
                                <span>RAM</span>
                                <span id="ram-val" class="text-pink-300">0%</span>
                            </div>
                            <div class="h-1 bg-slate-700 rounded-full overflow-hidden">
                                <div id="ram-bar" class="h-full bg-pink-500 rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-3 rounded-xl flex items-center space-x-3">
                    <div class="relative">
                        <div id="ping-dot" class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                    </div>
                    <div>
                        <p class="text-[10px] text-slate-400 uppercase">Latency</p>
                        <p id="ping-val" class="text-xs font-mono font-bold text-emerald-400">...</p>
                    </div>
                </div>
            </div>
        </aside>

        <main class="flex-1 overflow-y-auto relative p-4 md:p-8 scroll-smooth pb-32 md:pb-8">
            
            <header class="md:hidden flex justify-between items-center mb-6 px-2">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-pink-500 rounded-lg flex items-center justify-center">
                        <i class="fa-solid fa-robot text-white text-xs"></i>
                    </div>
                    <h2 class="text-lg font-bold">WIA DEV</h2>
                </div>
                <div id="clock-mobile" class="text-sm font-mono text-indigo-300 bg-slate-800/50 px-3 py-1 rounded-full border border-slate-700">00:00</div>
            </header>

            <section id="section-home" class="space-y-6 max-w-6xl mx-auto page-enter">
                
                <div class="glass-panel rounded-3xl p-8 md:p-14 relative overflow-hidden slide-up group">
                    <div class="absolute top-0 right-0 -mr-20 -mt-20 w-80 h-80 bg-indigo-600/20 rounded-full blur-3xl group-hover:bg-indigo-600/30 transition-all duration-700"></div>
                    <div class="relative z-10">
                        <div class="inline-flex items-center px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/30 text-indigo-300 text-xs font-bold mb-6 animate-pulse">
                            <span class="flex w-2 h-2 bg-indigo-500 rounded-full mr-2"></span> SYSTEM OPERATIONAL
                        </div>
                        <h1 class="text-4xl md:text-7xl font-black mb-6 font-['Space_Grotesk'] leading-tight tracking-tight">
                            DOMINATE <br>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400">YOUR WORKFLOW</span>
                        </h1>
                        <p class="text-slate-400 max-w-xl text-lg md:text-xl mb-10 leading-relaxed">
                            ‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå Form Automation ‡∏£‡∏∞‡∏î‡∏±‡∏ö Enterprise ‡πÄ‡∏£‡πá‡∏ß ‡πÅ‡∏£‡∏á ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö Multi-Thread Engine ‡πÅ‡∏•‡∏∞ Smart Input System ‡πÉ‡∏´‡∏°‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                        </p>
                        <div class="flex flex-col md:flex-row gap-4">
                            <button onclick="switchTab('tool')" class="bg-white text-slate-900 px-8 py-4 rounded-full font-bold hover:scale-105 transition-transform shadow-[0_0_30px_rgba(255,255,255,0.2)] flex items-center justify-center">
                                LAUNCH CONSOLE <i class="fa-solid fa-rocket ml-2"></i>
                            </button>
                            <a href="https://github.com/wiayouhi" target="_blank" class="bg-slate-800/50 border border-slate-600 text-white px-8 py-4 rounded-full font-bold hover:bg-slate-800 transition-colors flex items-center justify-center">
                                <i class="fa-brands fa-github mr-2"></i> GITHUB REPO
                            </a>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="glass-panel p-6 rounded-2xl tilt-card slide-up" style="animation-delay: 0.1s">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-slate-400 text-xs uppercase tracking-widest font-bold">Bangkok Time</p>
                                <h2 id="clock-time" class="text-4xl font-mono font-bold mt-2 text-white">--:--</h2>
                                <p id="clock-date" class="text-indigo-400 text-sm mt-1">Syncing...</p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-slate-800/50 flex items-center justify-center">
                                <i class="fa-regular fa-clock text-xl text-slate-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="glass-panel p-6 rounded-2xl tilt-card slide-up" style="animation-delay: 0.2s">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-slate-400 text-xs uppercase tracking-widest font-bold">Weather Data</p>
                                <div class="flex items-end mt-2">
                                    <h2 id="weather-temp" class="text-4xl font-bold text-white">--</h2>
                                    <span class="text-lg text-slate-400 mb-1 ml-1">¬∞C</span>
                                </div>
                                <p id="weather-desc" class="text-emerald-400 text-sm mt-1 flex items-center"><i class="fa-solid fa-wifi text-[10px] mr-1"></i> Live</p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-slate-800/50 flex items-center justify-center">
                                <i id="weather-icon" class="fa-solid fa-cloud text-xl text-slate-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="glass-panel p-6 rounded-2xl tilt-card slide-up" style="animation-delay: 0.3s">
                        <div class="flex items-center gap-4">
                            <div class="relative">
                                <img src="https://github.com/wiayouhi.png" class="w-14 h-14 rounded-full border-2 border-indigo-500 shadow-lg shadow-indigo-500/20">
                                <div class="absolute -bottom-1 -right-1 bg-slate-900 rounded-full p-1">
                                    <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                </div>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 uppercase tracking-wider">Lead Developer</p>
                                <h3 class="font-bold text-lg text-white">Thanawat Wia</h3>
                                <div class="flex space-x-3 mt-1 text-slate-400">
                                    <a href="#" class="hover:text-indigo-400 transition-colors"><i class="fa-solid fa-code"></i></a>
                                    <a href="#" class="hover:text-pink-400 transition-colors"><i class="fa-brands fa-instagram"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-6 md:p-8 rounded-2xl slide-up relative overflow-hidden" style="animation-delay: 0.4s">
                    <div class="absolute -right-6 -top-6 text-slate-800/30 rotate-12">
                        <i class="fa-brands fa-discord text-[150px]"></i>
                    </div>
                    
                    <div class="relative z-10 flex flex-col md:flex-row items-center gap-8">
                        <div class="flex items-center gap-4 bg-slate-900/40 p-4 rounded-xl border border-slate-700/50 w-full md:w-auto min-w-[240px]">
                            <div class="relative">
                                <img id="discord-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" class="w-16 h-16 rounded-full border-2 border-slate-700/50 transition-all duration-500">
                                <div id="discord-main-status" class="absolute bottom-0 right-0 w-5 h-5 bg-gray-500 border-4 border-[#13151b] rounded-full"></div>
                            </div>
                            <div>
                                <h4 id="discord-username" class="font-bold text-lg text-white leading-tight">Loading...</h4>
                                <p id="discord-tag" class="text-xs text-slate-400 font-mono">@...</p>
                                <div class="mt-1 inline-block px-2 py-0.5 bg-slate-800 rounded text-[10px] text-slate-300 border border-slate-700">PRO USER</div>
                            </div>
                        </div>

                        <div class="hidden md:block w-px h-16 bg-gradient-to-b from-transparent via-slate-600 to-transparent"></div>

                        <div class="flex-1 w-full">
                            <h3 class="text-xs font-bold text-indigo-400 uppercase mb-3 flex items-center">
                                <i class="fa-solid fa-gamepad mr-2"></i> Current Activity
                            </h3>
                            <div class="flex items-center gap-4">
                                <img id="discord-activity-img" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" class="w-12 h-12 rounded-lg bg-slate-800 object-cover opacity-50">
                                <div>
                                    <p id="discord-activity-name" class="font-bold text-white text-lg">No Game Detected</p>
                                    <p id="discord-activity-details" class="text-sm text-slate-400">System Standing By</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="section-tool" class="hidden space-y-6 max-w-6xl mx-auto">
                
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold font-['Space_Grotesk']">Automation Console</h2>
                        <p class="text-xs text-slate-400">Control Panel / <span class="text-indigo-400">Active</span></p>
                    </div>
                    <button onclick="window.location.reload()" class="w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center hover:bg-slate-700 text-slate-400 transition-colors">
                        <i class="fa-solid fa-rotate-right"></i>
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    
                    <div class="lg:col-span-2 space-y-6">
                        
                        <div class="glass-panel p-5 md:p-6 rounded-2xl">
                            <label class="text-[10px] font-bold text-indigo-400 uppercase tracking-wider mb-2 block">
                                <i class="fa-solid fa-link mr-1"></i> Target Form URL (Prefill Link)
                            </label>
                            <div class="flex flex-col md:flex-row gap-2">
                                <input type="text" id="url" class="flex-1 bg-slate-900/50 border border-slate-700 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-white placeholder-slate-600" placeholder="https://docs.google.com/forms/d/e/.../viewform?usp=pp_url...">
                                <button onclick="fetchEntries()" class="bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-bold text-sm shadow-lg shadow-indigo-600/20 active:scale-95 transition-all flex justify-center items-center">
                                    <i class="fa-solid fa-cloud-arrow-down mr-2"></i> FETCH
                                </button>
                            </div>
                        </div>

                        <div class="glass-panel p-5 md:p-6 rounded-2xl min-h-[300px] flex flex-col">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-sm flex items-center">
                                    <i class="fa-solid fa-list-check mr-2 text-pink-500"></i> Form Entries
                                </h3>
                                <button onclick="addManualEntry()" class="text-xs bg-slate-800 hover:bg-slate-700 px-3 py-1.5 rounded-lg transition-colors border border-slate-700">
                                    <i class="fa-solid fa-plus mr-1"></i> Manual Add
                                </button>
                            </div>
                            
                            <div id="entry-list" class="space-y-4 flex-1 overflow-y-auto pr-2 custom-scrollbar">
                                <div class="h-full flex flex-col items-center justify-center text-slate-500 border-2 border-dashed border-slate-800 rounded-xl p-8">
                                    <div class="w-12 h-12 bg-slate-800/50 rounded-full flex items-center justify-center mb-3">
                                        <i class="fa-solid fa-arrow-up text-indigo-400"></i>
                                    </div>
                                    <p class="text-sm font-medium">Waiting for URL</p>
                                    <p class="text-xs opacity-60">Paste URL and click Fetch to load entries</p>
                                </div>
                            </div>
                        </div>

                        <div class="glass-panel p-5 md:p-6 rounded-2xl">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                                <div>
                                    <label class="block text-[10px] text-slate-400 font-bold mb-1.5 ml-1">TOTAL JOBS</label>
                                    <input type="number" id="total" value="50" class="w-full bg-slate-900/50 border border-slate-700 rounded-xl p-3 text-center font-mono focus:border-indigo-500 focus:outline-none transition-colors">
                                </div>
                                <div>
                                    <label class="block text-[10px] text-slate-400 font-bold mb-1.5 ml-1">THREADS</label>
                                    <input type="number" id="bots" value="10" class="w-full bg-slate-900/50 border border-slate-700 rounded-xl p-3 text-center font-mono focus:border-indigo-500 focus:outline-none transition-colors">
                                </div>
                                <div>
                                    <label class="block text-[10px] text-slate-400 font-bold mb-1.5 ml-1">DELAY (S)</label>
                                    <input type="number" id="delay" value="0.5" step="0.1" class="w-full bg-slate-900/50 border border-slate-700 rounded-xl p-3 text-center font-mono focus:border-indigo-500 focus:outline-none transition-colors">
                                </div>
                                <div>
                                    <label class="block text-[10px] text-pink-400 font-bold mb-1.5 ml-1">PAGES</label>
                                    <input type="number" id="pages" value="1" min="1" class="w-full bg-slate-900/50 border border-pink-500/50 rounded-xl p-3 text-center font-mono focus:border-pink-500 focus:outline-none transition-colors text-pink-400 font-bold">
                                </div>
                            </div>
                            
                            <div class="flex gap-3">
                                <button onclick="startProcess()" id="btn-start" class="flex-1 py-4 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 font-bold text-lg shadow-[0_0_20px_rgba(99,102,241,0.4)] hover:shadow-[0_0_30px_rgba(99,102,241,0.6)] hover:scale-[1.01] active:scale-95 transition-all relative overflow-hidden group text-white">
                                    <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                                    <span class="relative z-10 flex items-center justify-center">
                                        <i class="fa-solid fa-play mr-2"></i> START SYSTEM
                                    </span>
                                </button>
                                
                                <button onclick="stopProcess()" id="btn-stop" class="hidden w-20 md:w-32 rounded-xl bg-red-500/10 border border-red-500/50 text-red-400 font-bold hover:bg-red-500 hover:text-white transition-all active:scale-95">
                                    STOP
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-1 flex flex-col gap-6">
                        <div class="glass-panel p-5 rounded-2xl">
                            <h3 class="text-xs font-bold text-slate-400 uppercase mb-4">Realtime Metrics</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-emerald-500/5 border border-emerald-500/20 p-4 rounded-xl text-center relative overflow-hidden">
                                    <div class="absolute inset-0 bg-emerald-500/10 blur-xl"></div>
                                    <h4 id="stat-success" class="text-3xl font-black text-emerald-400 relative z-10">0</h4>
                                    <p class="text-[10px] font-bold text-emerald-200/70 relative z-10 mt-1">SUCCESSFUL</p>
                                </div>
                                <div class="bg-red-500/5 border border-red-500/20 p-4 rounded-xl text-center relative overflow-hidden">
                                    <div class="absolute inset-0 bg-red-500/10 blur-xl"></div>
                                    <h4 id="stat-fail" class="text-3xl font-black text-red-400 relative z-10">0</h4>
                                    <p class="text-[10px] font-bold text-red-200/70 relative z-10 mt-1">FAILED</p>
                                </div>
                            </div>
                        </div>

                        <div class="glass-panel rounded-2xl flex-1 flex flex-col overflow-hidden border border-slate-700 h-[450px] md:h-auto shadow-2xl">
                            <div class="bg-[#0b101b] p-3 px-4 flex justify-between items-center border-b border-slate-800">
                                <div class="flex items-center space-x-2">
                                    <i class="fa-solid fa-terminal text-slate-500 text-xs"></i>
                                    <span class="text-xs font-mono text-slate-400">root@wia-server:~</span>
                                </div>
                                <div class="flex space-x-1.5">
                                    <div class="w-2.5 h-2.5 rounded-full bg-slate-600"></div>
                                    <div class="w-2.5 h-2.5 rounded-full bg-slate-600"></div>
                                </div>
                            </div>
                            <div id="log-container" class="flex-1 bg-[#05080f] p-4 font-mono text-[11px] md:text-xs overflow-y-auto space-y-1.5 text-slate-300">
                                <div class="text-indigo-400">> Initializing WIA Automate Pro V2.5...</div>
                                <div class="text-emerald-400">> System interfaces loaded.</div>
                                <div class="text-slate-500">> Waiting for command input...</div>
                            </div>
                        </div>
                    </div>

                </div>
            </section>
        </main>

        <div class="md:hidden fixed bottom-6 left-6 right-6 z-50">
            <div class="mobile-dock rounded-2xl p-2 flex justify-around items-center">
                <button onclick="switchTab('home')" id="mob-nav-home" class="mobile-nav-btn active flex-1 py-3 rounded-xl transition-all flex flex-col items-center justify-center text-slate-400 active:bg-slate-800/50">
                    <i class="fa-solid fa-house text-xl mb-1 transition-all"></i>
                    <span class="text-[10px] font-bold">Home</span>
                </button>
                <div class="w-px h-8 bg-slate-700/50"></div>
                <button onclick="switchTab('tool')" id="mob-nav-tool" class="mobile-nav-btn flex-1 py-3 rounded-xl transition-all flex flex-col items-center justify-center text-slate-400 active:bg-slate-800/50">
                    <i class="fa-solid fa-bolt text-xl mb-1 transition-all"></i>
                    <span class="text-[10px] font-bold">Console</span>
                </button>
            </div>
        </div>

    </div>

    <script>
        // ==========================================
        // üîî 1. ADVANCED TOAST NOTIFICATION (MOBILE READY)
        // ==========================================
        function showToast(message, type = 'info') {
            // 1. ‡∏´‡∏≤ Container ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà (Auto-Create & Responsive Positioning)
            let container = document.getElementById('toast-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'toast-container';
                // Mobile: ‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ / Desktop: ‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô
                container.className = "fixed top-0 left-0 right-0 md:left-auto md:right-6 md:top-6 z-[9999] flex flex-col gap-2 p-4 pointer-events-none sm:max-w-[400px]";
                document.body.appendChild(container);
            }

            const toast = document.createElement('div');
            
            // 2. ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡πÅ‡∏ö‡∏ö Neon Glow
            const themes = {
                error:   { border: 'border-rose-500',   bg: 'bg-rose-500/20', icon: 'fa-triangle-exclamation', text: 'text-rose-400',   shadow: 'shadow-rose-500/20' },
                success: { border: 'border-emerald-500', bg: 'bg-emerald-500/20', icon: 'fa-circle-check',       text: 'text-emerald-400', shadow: 'shadow-emerald-500/20' },
                info:    { border: 'border-indigo-500',    bg: 'bg-indigo-500/20',    icon: 'fa-circle-info',        text: 'text-indigo-400',    shadow: 'shadow-indigo-500/20' }
            };
            const s = themes[type] || themes.info;

            // 3. Styling: Glassmorphism + Responsive Layout
            toast.className = `
                pointer-events-auto 
                relative w-full 
                flex items-center gap-4 p-4 
                bg-slate-900/95 backdrop-blur-xl 
                border-l-[4px] ${s.border} border-y border-r border-slate-700/50
                rounded-xl shadow-2xl ${s.shadow}
                transform transition-all duration-500 ease-[cubic-bezier(0.68,-0.55,0.27,1.55)] 
                translate-y-[-50px] opacity-0 scale-95
            `;

            toast.innerHTML = `
                <div class="shrink-0">
                    <div class="w-10 h-10 rounded-full ${s.bg} flex items-center justify-center border border-white/5 shadow-inner">
                        <i class="fa-solid ${s.icon} ${s.text} text-lg drop-shadow-[0_0_8px_rgba(255,255,255,0.3)]"></i>
                    </div>
                </div>
                <div class="flex-1 min-w-0">
                    <h4 class="font-bold text-[10px] uppercase tracking-widest ${s.text} mb-0.5 opacity-90">${type}</h4>
                    <p class="text-sm font-medium text-slate-200 leading-snug break-words">${message}</p>
                </div>
                <button onclick="this.parentElement.classList.add('opacity-0','translate-x-full'); setTimeout(()=>this.parentElement.remove(), 300);" 
                    class="shrink-0 w-8 h-8 flex items-center justify-center rounded-lg text-slate-500 hover:text-white hover:bg-white/10 transition-colors">
                    <i class="fa-solid fa-xmark text-sm"></i>
                </button>
            `;

            container.appendChild(toast);

            // Trigger Animation Slide In
            requestAnimationFrame(() => {
                toast.classList.remove('translate-y-[-50px]', 'opacity-0', 'scale-95');
            });

            // Auto Remove logic (4 seconds)
            setTimeout(() => {
                if(toast.parentElement) {
                    toast.classList.add('opacity-0', 'translate-x-[50px]', 'scale-95');
                    setTimeout(() => toast.remove(), 500);
                }
            }, 4000);
        }

        // ==========================================
        // üöÄ 2. SYSTEM INIT & SMOOTH NAVIGATION
        // ==========================================
        window.addEventListener('load', () => {
            // Loader Animation
            setTimeout(() => {
                const loader = document.getElementById('loader');
                if(loader) {
                    loader.style.transition = 'opacity 0.5s ease';
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 500);
                }
                
                // Page Entry Animation
                const homeSection = document.getElementById('section-home');
                if(homeSection) homeSection.classList.add('page-enter');
            }, 1000);
        });

        function switchTab(tab) {
            const home = document.getElementById('section-home');
            const tool = document.getElementById('section-tool');
            
            // Navbar Items (Desktop & Mobile)
            const navItems = {
                home: [document.getElementById('nav-home'), document.getElementById('mob-nav-home')],
                tool: [document.getElementById('nav-tool'), document.getElementById('mob-nav-tool')]
            };

            const toggleActive = (items, isActive) => {
                items.forEach(el => {
                    if(el) isActive ? el.classList.add('active') : el.classList.remove('active');
                });
            };

            if(tab === 'home') {
                if(!home.classList.contains('hidden')) return;
                
                // Animate Out Tool
                tool.classList.remove('page-enter');
                tool.classList.add('page-exit');

                setTimeout(() => {
                    tool.classList.add('hidden');
                    tool.classList.remove('page-exit');
                    
                    home.classList.remove('hidden');
                    // Force Reflow
                    void home.offsetWidth;
                    home.classList.add('page-enter');
                }, 300);

                toggleActive(navItems.home, true);
                toggleActive(navItems.tool, false);

            } else {
                if(!tool.classList.contains('hidden')) return;

                home.classList.remove('page-enter');
                home.classList.add('page-exit');

                setTimeout(() => {
                    home.classList.add('hidden');
                    home.classList.remove('page-exit');
                    
                    tool.classList.remove('hidden');
                    void tool.offsetWidth;
                    tool.classList.add('page-enter');
                }, 300);

                toggleActive(navItems.home, false);
                toggleActive(navItems.tool, true);
            }
        }

        // ==========================================
        // üìä 3. DASHBOARD STATS (Optimized)
        // ==========================================
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'});
            
            const elTime = document.getElementById('clock-time');
            const elDate = document.getElementById('clock-date');
            const elMob = document.getElementById('clock-mobile');

            if(elTime) elTime.innerText = timeStr;
            if(elDate) elDate.innerText = now.toLocaleDateString('en-US', {weekday:'short', day:'numeric', month:'short'});
            if(elMob) elMob.innerText = timeStr;
        }
        setInterval(updateTime, 1000); updateTime();

        async function fetchServerStats() {
            try {
                const res = await fetch('/api/stats');
                if(res.ok) {
                    const data = await res.json();
                    const cpuBar = document.getElementById('cpu-bar');
                    
                    if(document.getElementById('cpu-val')) document.getElementById('cpu-val').innerText = `${data.cpu}%`;
                    if(cpuBar) {
                        cpuBar.style.width = `${data.cpu}%`;
                        cpuBar.className = `h-full rounded-full transition-all duration-500 shadow-[0_0_10px_currentColor] ${data.cpu > 80 ? 'bg-rose-500 text-rose-500' : 'bg-indigo-500 text-indigo-500'}`;
                    }
                    
                    if(document.getElementById('ram-val')) document.getElementById('ram-val').innerText = `${data.ram}%`;
                    if(document.getElementById('ram-bar')) document.getElementById('ram-bar').style.width = `${data.ram}%`;
                }
            } catch(e) {}
        }
        setInterval(fetchServerStats, 3000);

        async function fetchWeather() {
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=13.75&longitude=100.51&current_weather=true');
                const data = await res.json();
                if(document.getElementById('weather-temp')) document.getElementById('weather-temp').innerText = Math.round(data.current_weather.temperature);
                if(document.getElementById('weather-desc')) document.getElementById('weather-desc').innerHTML = `<i class="fa-solid fa-wind mr-1"></i> ${data.current_weather.windspeed} km/h`;
            } catch(e) {}
        }
        fetchWeather();

        async function fetchPing() {
            const start = Date.now();
            const pingEl = document.getElementById('ping-val');
            const dot = document.getElementById('ping-dot');

            try {
                await fetch('/ping'); 
                const latency = Date.now() - start;
                
                if(pingEl) pingEl.innerText = `${latency} ms`;
                
                if(dot && pingEl) {
                    if(latency < 100) {
                        pingEl.className = "text-xs font-mono font-bold text-emerald-400 drop-shadow-[0_0_5px_rgba(52,211,153,0.5)]";
                        dot.className = "w-2.5 h-2.5 rounded-full animate-pulse bg-emerald-500 shadow-[0_0_10px_#10b981]";
                    } else if (latency < 300) {
                        pingEl.className = "text-xs font-mono font-bold text-yellow-400";
                        dot.className = "w-2.5 h-2.5 rounded-full animate-pulse bg-yellow-500 shadow-[0_0_10px_#eab308]";
                    } else {
                        pingEl.className = "text-xs font-mono font-bold text-rose-400";
                        dot.className = "w-2.5 h-2.5 rounded-full animate-pulse bg-rose-500 shadow-[0_0_10px_#f43f5e]";
                    }
                }
            } catch(e) {
                if(pingEl) pingEl.innerText = "Offline";
                if(dot) dot.className = "w-2.5 h-2.5 rounded-full bg-slate-600";
            }
        }
        setInterval(fetchPing, 2000);
        fetchPing();

        // ==========================================
        // üéÆ 4. DISCORD LANYARD INTEGRATION
        // ==========================================
        const DISCORD_ID = "902739412172046427"; 
        const ws = new WebSocket("wss://api.lanyard.rest/socket");
        ws.onopen = () => ws.send(JSON.stringify({ op: 2, d: { subscribe_to_ids: [DISCORD_ID] } }));
        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            if(data.op === 1) setInterval(() => ws.send(JSON.stringify({ op: 3 })), data.d.heartbeat_interval);
            if(data.t === "INIT_STATE" || data.t === "PRESENCE_UPDATE") updateDiscord(data.d);
        };
        
        function updateDiscord(d) {
            const user = d[DISCORD_ID] || d; 
            if(!user) return;
            
            if(user.discord_user) {
                document.getElementById('discord-username').innerText = user.discord_user.global_name || user.discord_user.username;
                document.getElementById('discord-tag').innerText = `@${user.discord_user.username}`;
                const av = `https://cdn.discordapp.com/avatars/${user.discord_user.id}/${user.discord_user.avatar}.png`;
                if(document.getElementById('discord-avatar').src !== av) {
                    document.getElementById('discord-avatar').src = av;
                }
            }

            const statusColors = { online: 'bg-emerald-500', idle: 'bg-yellow-500', dnd: 'bg-rose-500', offline: 'bg-gray-500' };
            const color = statusColors[user.discord_status] || 'bg-gray-500';
            document.getElementById('discord-main-status').className = `absolute bottom-0 right-0 w-5 h-5 border-4 border-[#13151b] rounded-full ${color}`;

            const activity = user.activities.find(a => a.type === 0 || a.type === 2);
            if(activity) {
                document.getElementById('discord-activity-name').innerText = activity.name;
                document.getElementById('discord-activity-details').innerText = activity.details || activity.state || "Playing";
                if(activity.assets?.large_image) {
                    let url = activity.assets.large_image.startsWith("mp:") 
                        ? `https://media.discordapp.net/${activity.assets.large_image.replace("mp:", "")}`
                        : `https://cdn.discordapp.com/app-assets/${activity.application_id}/${activity.assets.large_image}.png`;
                    document.getElementById('discord-activity-img').src = url;
                    document.getElementById('discord-activity-img').classList.remove('opacity-50');
                }
            }
        }

        // ==========================================
        // ‚ú® 5. BEAUTIFUL ENTRY CARD SYSTEM
        // ==========================================

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á Tag ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
        function createTagUI(containerId, value) {
            if(!value.trim()) return;
            const container = document.getElementById(containerId);
            const span = document.createElement('span');
            
            span.className = "group animate-[scaleIn_0.2s_ease-out] inline-flex items-center gap-2 pl-3 pr-2 py-1.5 bg-slate-800 border border-indigo-500/30 rounded-lg text-sm text-indigo-100 hover:border-indigo-400 transition-colors shadow-sm cursor-default select-none tag-chip";
            span.dataset.value = value.trim();
            span.innerHTML = `
                <span class="font-mono text-xs opacity-80">${value}</span>
                <button onclick="deleteTag(this)" class="w-5 h-5 flex items-center justify-center rounded-md text-slate-400 hover:text-rose-400 hover:bg-rose-500/10 transition-all">
                    <i class="fa-solid fa-xmark text-xs"></i>
                </button>
            `;
            container.appendChild(span);
        }
        
        function deleteTag(btn) {
            const tag = btn.closest('span');
            tag.style.transform = 'scale(0.8) opacity(0)';
            setTimeout(() => tag.remove(), 200);
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î (Ultimate Glass Card)
        function createEntryCard(id, initialVal, isManual) {
            const uid = Math.random().toString(36).substr(2, 9);
            const card = document.createElement('div');
            
            card.className = "group relative bg-slate-800/40 backdrop-blur-md p-6 rounded-2xl border border-slate-700/50 hover:border-indigo-500/40 hover:bg-slate-800/60 hover:shadow-[0_8px_30px_rgb(0,0,0,0.12)] transition-all duration-300 ease-out mb-5 overflow-hidden";
            card.id = `card-${uid}`;
            
            const idInputClass = isManual 
                ? "bg-slate-900/50 border-b-2 border-indigo-500/50 text-indigo-300 placeholder-indigo-500/30 px-2 py-1 focus:border-indigo-400 focus:bg-slate-900 transition-all cursor-text pointer-events-auto" 
                : "bg-transparent text-slate-400 border-none px-0 cursor-default pointer-events-none font-bold";

            const labelIcon = isManual 
                ? `<i class="fa-solid fa-pen-nib text-indigo-400 mr-2 animate-bounce"></i>` 
                : `<i class="fa-brands fa-google text-slate-500 mr-2"></i>`;

            card.innerHTML = `
                <div class="absolute -top-10 -right-10 w-32 h-32 bg-indigo-500/5 rounded-full blur-3xl pointer-events-none group-hover:bg-indigo-500/10 transition-colors duration-500"></div>

                <div class="flex justify-between items-start mb-5 relative z-10">
                    <div class="flex flex-col gap-1 flex-1 mr-4">
                        <label class="text-[10px] uppercase tracking-widest font-bold text-slate-500 mb-1 flex items-center">
                            ${labelIcon} ${isManual ? 'MANUAL ENTRY ID' : 'FORM FIELD ID'}
                        </label>
                        <div class="flex items-center gap-3">
                            <input value="${id || ''}" 
                                class="text-sm font-mono tracking-wide w-full focus:outline-none rounded-md ${idInputClass}" 
                                ${isManual ? '' : 'readonly'} 
                                placeholder="entry.xxxxxxxxx">
                        </div>
                    </div>
                    
                    ${isManual ? `
                    <button onclick="removeCard('card-${uid}')" 
                        class="text-slate-500 hover:text-rose-400 bg-slate-800/50 hover:bg-rose-500/10 w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-200 shadow-sm border border-transparent hover:border-rose-500/20"
                        title="Remove this field">
                        <i class="fa-solid fa-trash-can text-sm"></i>
                    </button>` : ''}
                </div>
                
                <div id="tags-${uid}" class="flex flex-wrap gap-2 mb-4 min-h-[50px] p-3 bg-slate-950/30 rounded-xl border border-dashed border-slate-700/50 transition-colors hover:border-indigo-500/30 relative">
                     <div class="absolute inset-0 flex items-center justify-center pointer-events-none opacity-0 only:opacity-100 transition-opacity duration-300">
                        <div class="text-center">
                            <i class="fa-solid fa-arrow-turn-down text-slate-600 mb-1 block"></i>
                            <span class="text-xs text-slate-600 font-medium">Add answers below</span>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-3 relative z-10">
                    <div class="flex gap-2">
                        <div class="relative flex-1 group/input">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-keyboard text-slate-500 group-focus-within/input:text-indigo-400 transition-colors"></i>
                            </div>
                            <input id="input-${uid}" type="text" 
                                class="w-full bg-slate-900/60 border border-slate-700/80 rounded-xl pl-10 pr-4 py-2.5 text-sm text-white placeholder-slate-600 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500/50 focus:bg-slate-900/90 focus:outline-none transition-all shadow-inner" 
                                placeholder="Type answer & press Enter..."
                                autocomplete="off"
                                onkeypress="handleInputEnter(event, 'input-${uid}', 'tags-${uid}')">
                        </div>
                        
                        <button onclick="toggleBulk('${uid}')" 
                            class="bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-400 hover:text-indigo-300 px-4 rounded-xl transition-all shadow-sm flex items-center justify-center gap-2 hover:shadow-indigo-500/10 active:scale-95" 
                            title="Bulk Import">
                            <i class="fa-solid fa-list-ul"></i>
                        </button>
                    </div>

                    <div id="bulk-wrapper-${uid}" class="grid grid-rows-[0fr] transition-[grid-template-rows] duration-300 ease-out">
                        <div class="overflow-hidden">
                            <div class="pt-2 pb-1">
                                <div class="bg-slate-900/80 p-1 rounded-xl border border-slate-700/50">
                                    <textarea id="text-bulk-${uid}" 
                                        class="w-full bg-transparent border-none rounded-lg p-3 text-xs font-mono text-slate-300 h-24 focus:outline-none focus:ring-0 resize-none placeholder-slate-600 leading-relaxed" 
                                        placeholder="Paste multiple answers here...&#10;One answer per line"></textarea>
                                    <button onclick="processBulk('${uid}')" 
                                        class="w-full py-2 mt-1 bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 text-white rounded-lg text-xs font-bold tracking-wide shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2 border border-white/10">
                                        <i class="fa-solid fa-wand-magic-sparkles"></i> PROCESS BULK DATA
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between pt-3 border-t border-slate-700/30">
                        <div class="flex items-center gap-3 opacity-70 group-hover:opacity-100 transition-opacity">
                            <div class="w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center border border-slate-700 text-pink-500 shadow-inner">
                                <i class="fa-solid fa-fingerprint text-sm"></i>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xs font-bold text-slate-300">Unique Mode</span>
                                <span class="text-[10px] text-slate-500">Do not repeat answers</span>
                            </div>
                        </div>

                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="unique-${uid}" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-700/50 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gradient-to-r peer-checked:from-pink-500 peer-checked:to-rose-500 peer-checked:after:bg-white peer-checked:after:border-white shadow-inner"></div>
                        </label>
                    </div>
                </div>
            `;
            
            if(isManual) {
                setTimeout(() => {
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    const idInput = card.querySelector('input[placeholder*="entry."]');
                    if(idInput) {
                        idInput.focus();
                        idInput.select(); 
                    }
                }, 200);
            }

            return { card, uid };
        }

        // ==========================================
        // ‚öôÔ∏è 6. LOGIC & HELPERS
        // ==========================================

        function removeCard(cardId) {
            const el = document.getElementById(cardId);
            if(el) {
                el.style.transition = 'all 0.3s ease-in';
                el.style.transform = 'scale(0.9) translateY(20px)';
                el.style.opacity = '0';
                setTimeout(() => el.remove(), 300);
            }
        }

        function toggleBulk(uid) {
            const wrapper = document.getElementById(`bulk-wrapper-${uid}`);
            const isClosed = wrapper.classList.contains('grid-rows-[0fr]');
            
            if (isClosed) {
                wrapper.classList.remove('grid-rows-[0fr]');
                wrapper.classList.add('grid-rows-[1fr]');
                setTimeout(() => document.getElementById(`text-bulk-${uid}`).focus(), 150);
            } else {
                wrapper.classList.remove('grid-rows-[1fr]');
                wrapper.classList.add('grid-rows-[0fr]');
            }
        }

        function processBulk(uid) {
            const textarea = document.getElementById(`text-bulk-${uid}`);
            const lines = textarea.value.split('\n');
            let count = 0;
            
            lines.forEach(line => {
                if(line.trim()) {
                    createTagUI(`tags-${uid}`, line.trim()); 
                    count++;
                }
            });
            
            if(count > 0) {
                textarea.value = "";
                toggleBulk(uid);
                showToast(`Added ${count} answers successfully!`, 'success');
                
                const inputBar = document.getElementById(`input-${uid}`);
                inputBar.classList.add('!border-emerald-500', 'ring-2', 'ring-emerald-500/30');
                setTimeout(() => {
                     inputBar.classList.remove('!border-emerald-500', 'ring-2', 'ring-emerald-500/30');
                }, 800);
            }
        }

        function handleInputEnter(e, inputId, containerId) {
            if (e.key === 'Enter') {
                const input = document.getElementById(inputId);
                createTagUI(containerId, input.value);
                input.value = '';
            }
        }

        // ==========================================
        // üì° 7. DATA & PROCESS CONTROL
        // ==========================================

        async function fetchEntries() {
            const url = document.getElementById('url').value;
            const list = document.getElementById('entry-list');
            
            if(!url) return showToast("Please enter a valid URL first", "error");
            
            list.innerHTML = `
                <div class="flex flex-col items-center justify-center py-12 text-indigo-400 opacity-80">
                    <div class="relative w-16 h-16 mb-4">
                        <div class="absolute inset-0 border-4 border-indigo-500/30 rounded-full"></div>
                        <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
                    </div>
                    <span class="font-mono text-sm tracking-wider animate-pulse">SCANNING FORM STRUCTURE...</span>
                </div>
            `;

            try {
                const res = await fetch('/api/parse-url', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({url}) });
                const data = await res.json();
                list.innerHTML = "";

                if(Object.keys(data.entries).length === 0) {
                    list.innerHTML = `
                        <div class="text-center py-10 bg-slate-800/30 rounded-xl border border-dashed border-slate-700">
                            <i class="fa-solid fa-ghost text-4xl text-slate-600 mb-3"></i>
                            <p class="text-slate-400">No input fields found.</p>
                        </div>
                    `;
                    return;
                }

                for(const [k, v] of Object.entries(data.entries)) {
                    const { card, uid } = createEntryCard(k, v, false);
                    list.appendChild(card);
                    if(v) v.split(',').forEach((val, idx) => {
                        setTimeout(() => createTagUI(`tags-${uid}`, val), idx * 50);
                    });
                }
                showToast("Form Structure Loaded!", "success");
            } catch(e) { 
                list.innerHTML = `<div class="text-center py-8 text-rose-400 font-bold">Error Loading Data</div>`;
                showToast("Failed to fetch form data", "error");
            }
        }

        function addManualEntry() {
            const { card } = createEntryCard('', null, true);
            const list = document.getElementById('entry-list');
            if(list.innerText.includes('No input fields')) list.innerHTML = "";
            list.appendChild(card);
        }

        let evtSource;

        async function stopProcess() {
            await fetch('/api/stop', { method: 'POST' });
            const btn = document.getElementById('btn-start');
            btn.innerHTML = `<span class="flex items-center"><i class="fa-solid fa-spinner fa-spin mr-2"></i> STOPPING...</span>`;
        }

        function startProcess() {
            const url = document.getElementById('url').value;
            if(!url) return showToast("URL is required to start", "error");

            const entries = {};
            document.querySelectorAll('#entry-list > div[id^="card-"]').forEach(card => {
                const entryIdInput = card.querySelector('input[placeholder*="entry."]');
                if(!entryIdInput) return;
                
                const entryId = entryIdInput.value;
                const tagSpans = card.querySelectorAll('.tag-chip, span[data-value]');
                const values = Array.from(tagSpans).map(span => span.dataset.value).join(',');
                
                const uniqueCheckbox = card.querySelector('input[type="checkbox"]'); 
                const isUnique = uniqueCheckbox ? uniqueCheckbox.checked : false;
                
                if(entryId && values) {
                    entries[entryId] = { values: values, unique: isUnique };
                }
            });

            if(Object.keys(entries).length === 0) return showToast("Please add at least one entry and answer", "error");

            const params = new URLSearchParams({
                url: url,
                total: document.getElementById('total').value,
                bots: document.getElementById('bots').value,
                delay: document.getElementById('delay').value,
                pages: document.getElementById('pages').value,
                entries: JSON.stringify(entries),
                mode: 'R' 
            });

            const btn = document.getElementById('btn-start');
            const btnStop = document.getElementById('btn-stop');
            
            btn.innerHTML = `<i class="fa-solid fa-circle-notch fa-spin mr-2"></i> PROCESSING...`;
            btn.classList.add('opacity-75', 'cursor-not-allowed');
            btn.disabled = true;
            btnStop.classList.remove('hidden');

            const logBox = document.getElementById('log-container');
            logBox.innerHTML = "";
            document.getElementById('stat-success').innerText = "0";
            document.getElementById('stat-fail').innerText = "0";

            showToast("üöÄ System Started Successfully", "success");

            if(evtSource) evtSource.close();
            evtSource = new EventSource(`/api/stream?${params.toString()}`);
            
            evtSource.onmessage = (e) => {
                const div = document.createElement('div');
                div.className = "mb-1 text-xs font-mono break-all opacity-0 animate-[fadeIn_0.2s_ease-out_forwards]";
                div.innerText = "> " + e.data;
                
                if(e.data.includes('SUCCESS')) {
                    div.classList.add('text-emerald-400');
                    let s = document.getElementById('stat-success'); s.innerText = parseInt(s.innerText)+1;
                } else if(e.data.includes('FAIL')) {
                    div.classList.add('text-rose-400');
                    let s = document.getElementById('stat-fail'); s.innerText = parseInt(s.innerText)+1;
                } else if(e.data.includes('FINISHED') || e.data.includes('Stopped')) {
                    div.className = "mt-4 pt-2 border-t border-slate-700 text-yellow-400 font-bold text-center";
                    evtSource.close();
                    btn.innerHTML = `<span class="relative z-10 flex items-center justify-center"><i class="fa-solid fa-play mr-2"></i> START SYSTEM</span>`;
                    btn.classList.remove('opacity-75', 'cursor-not-allowed');
                    btn.disabled = false;
                    btnStop.classList.add('hidden');
                    showToast("Process Finished", "info");
                }
                logBox.appendChild(div);
                logBox.scrollTop = logBox.scrollHeight;
            };
            
            evtSource.onerror = () => {
                evtSource.close();
                btn.innerHTML = "RESTART";
                btn.disabled = false;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
                btnStop.classList.add('hidden');
                showToast("Connection Lost", "error");
            }
        }
    </script>
</body>
</html>
